# 一、OpenCV识别程序

## 1\. 项目介绍

本项目实现了对所给视频中的 **装甲板**与 **能量机关**进行识别，并加入了卡尔曼滤波器进行 **轨迹预测**，其中已经对不同的模块进行了 **封装**。

## 2\. 使用方法

将项目文件下载好后，进行cmake编译，然后把需要识别的视频放在 **项目的根目录**下（ _即同cmakelist文件同一级目录下_），输入./demo运行，根据提示运行即可。

**注意**：因为在Ubuntu终端下中文有可能显示乱码，下面说明一下要输入什么。

1.  首先输入数字1选择识别装甲板，输入数字2则识别能量机关
2.  如果选择识别装甲板，那么再选择敌方装甲板颜色，输入 0为蓝色 ， 1为红色
3.  如果选择识别能量机关，那么再选择需要击打的能量机关的颜色 0为红色， 1为蓝色
4.  进行完上述两步的选择，第三步是输入视频的名称（ **注意要带后缀，如1.avi**）
5.  **注意每一步输入都要回车确定**！

## 3\. 识别原理

### 3-1\. 装甲板：

对于装甲板的识别，我是采用多种条件进行约束，来筛选哪个是装甲板。其中分为两步，第一步是筛选灯条，用合适的宽高比、凸度、旋转角度来筛选。第二部是匹配灯条，看灯条是否平行，长宽比如何，是否在同一高度来判定两个灯条是否属于同一个装甲板。

### 3-2\. 能量机关：

对于能量机关的识别，我是查看一个轮廓里有多少个子轮廓来判定的，击打板的轮廓内仅有一个轮廓，已经击打的板子内部有三个轮廓，再通过限制长宽比来避免误识别。

### 3-3\. 卡尔曼滤波预测：

对于轨迹的预测，我使用的是卡尔曼滤波器，装甲板视频里青蓝色的圈圈就是预测的点，而能量机关中绿色的小点就是预测的点。
在装甲板的视频里，因为无法得知控制量，所以我的模型中没有加入加速度，状态量为x，y，▲x，▲y，测量量为x与y。
而在能量机关的视频里，我是先找到了击打板与中心R标志，然后使用了圆旋转的模型，状态量为角度与角速度，测量量为角度。